共用 基板 管理 控制器 的 伺服器系統 及 方法 S ER V ER   SYSTEM   AND   ME HT OD   F OR   US IN G   SH ARE D   BA SEB OA RD   MAN AGE ME NT   CO NTR O LL ER 
 一種 共用 基板 管理 控制器 的 伺服器系統 及 方法 。 此 伺服器系統 包括 多個節點 、 集線器 及 子板 。 其中 ， 各個 節點 均 包括多個 針腳 。 集線器 具有 多個連接埠 及 切換器 ， 這些 連接埠 分別 連接 對應節點 的 針腳 ， 切換器 則 用以 切換 連接埠 。 子板 包括 一個 連接 至 切換器 的 基板 管理 控制器 ， 此 基板 管理 控制器 在 接收到 對於 節點 的 請求指令 時 ， 控制 切換器 切換 連接埠 ， 以將 此 節點連接 至 基板 管理 控制器 ， 並 藉由 通用 輸出 針腳 發出 安裝 訊號 ， 以 通知 此 節點 的 作業系統安裝 視訊介面 驅動程式 ， 並在 安裝 完成 後 ， 使得 此 節點 可 透過 基板 管理 控制器 的 裝置管理 功能 使用 子板 所 連接的 周邊裝置 。 A   server   system   and   a   method   for   using   a   shared   base board   management   controller   ( BMC )   are   provi de d .   The   server   system   co mp rise s   a   plur al ity   of   nodes ,   a   hub   and   a   management   board .   Each   of   the   nodes   co mp rise s   a   plur al ity   of   pin s .   The   hub   co mp rise s   a   plur al ity   of   connection   port s   and   a   switch ,   in   which   the   connection s   port s   are   respect iv el y   connected   to   the   pin s   of   co rre sp on di ng   nodes   and   the   switch   is   used   to   switch   a mo ng   the   connection   port s .   The   management   board   co mp rise s   a   BMC   connected   to   the   switch .   Wh en   receiving   a   request   command   for   one   of   the   nodes ,   the   BMC   controls   the   switch   to   switch   the   connection   port   to   co nn ect   the   node   to   the   BMC   and   sen ds   an   installation   signal   to   the   node   through   a   general   purpose   output   ( GP O )   pin ,   so   as   to   not ify   the   node   to   in stall   a   video   interface   driver .   After   the   installation   is   complete d ,   the   BMC   enab les   the   node   to   use   the   peripheral   device   connected   by   the   management   board   through   a   device   management   function   of   the   BMC . 
 本 發明 是 有 關於 一種 伺服器系統 及 方法 ， 且 特別 是 有 關於 一種 共用 基板 管理 控制器 的 伺服器系統 及 方法 。 
 就 伺服器 的 應用面 來 看 ， 若 是 作為 資料中心 ( Data   Center ) ， 則 系統中 的 每個 節點 ( Node ) 均 包含 視頻圖像 陣列 ( Video   Graphics   Array ， VGA ) 埠 、 序列埠 ( serial   port ) 、 基板 管理 控制器 ( Base board   Management   Controller ， BMC ) 等 元件 ， 在 無形 中 就 增加 了 製造 的 成本 ， 且 浪費 了 元件 本身 所 提供 的 功能性 以及 功能的 重複性 。 因為 在 大部分 的 時間 裡 ， 節點 上的 VGA 埠 及 序列埠 都 是 處 在 閒置狀態 ， 而 基板 管理 控制器 的 功能 也 是 可以 共用的 。 任何 一個 不必要 的 元件 ( 例如 VGA 埠 、 序列埠 ) 被 包含 在 量產 的 產品 中 ， 或者 是 功能重複 性的 元件 ( 例如 基板 管理 控制器 ) 被 配置 於 節點 上 ， 產品 的 價格 就 會 相對 地 增加 ， 競爭力 也 就 下降 了 。 
 若將 VGA 埠 或 序列埠 自 節點 上 移除 ， 如此 一來 ， 在 產品開發階段 的問題 就 來 了 ， 測試人員 在 測試機器 的 過程中 ， 很 多項目 必須 與 機器 面對面 的 人機互動 ， 因此 VGA 埠 或 序列埠 在 此 階段 是 不可或缺 的 工具 ， 如何 在 產品開發階段 的 必要性 以 及產品 的 競爭力 之間 取得 平衡 ， 成為 了 急需 解決 的 燙 手 山芋 。 
 本 發明 提供 一種 共用 基板 管理 控制器 的 伺服器系統 ， 可 讓 伺服器系統 中的 多個節點 共用 一個 基板 管理 控制器 。 
 本 發明 提供 一種 共用 基板 管理 控制器 的 方法 ， 藉由 將 基板 管理 控制器 的 連結 切換至 使用者選擇 的 節點 ， 以 利用 基板 管理 控制器 的 裝置管理 功能 對此 節點 進行操作 。 
 本 發明 提出 一種 共用 基板 管理 控制器 的 伺服器系統 ， 包括 多個節點 、 集線器 及 子板 。 其中 ， 各個 節點 包括多個 第一 連接 針腳 、 一個 第 一輸入 針腳 及 一個 第 一輸出 針腳 。 集線器 則 具有 多個連接埠 及 切換器 ， 這些 連接埠 分別 連接 對應節點 的 第一 連接 針腳 、 第 一輸入 針腳 及第 一輸出 針腳 ， 而 切換器 則 用以 切換 連接埠 。 子板 包括 可 連接 至 周邊裝置 的 連接單元 以及 基板 管理 控制器 ， 其中 基板 管理 控制器 具有 對應 於 所述 第一 連接 針腳 的 多個第二 連接 針腳 、 對應 於 第 一輸入 針腳 的 第 二輸出 針腳 以及 對應 於 第 一輸出 針腳 的 第二 輸入 針腳 ， 而 用以 連接切換 器及 連接單元 。 基板 管理控制 器係 接收 對於 上述 節點 其中 一個 節點 的 請求指令 ， 據 以 控制 切換器 切換 連接埠 ， 以將 此 節點連接 至 基板 管理 控制器 ， 使得 此 節點 可 透過 基板 管理 控制器 的 裝置管理 功能 使用 該些 周邊裝置 。 其中 ， 基板 管理控制 器係 透過 第 二輸出 針腳 輸出 一 安裝 訊號 至 所要 切換到 之 節點 的 第 一輸入 針腳 ， 以 通知 此 節點 安裝 視訊介面 驅動程式 ， 並 透過 第二 輸入 針腳 接收 此 節點 透過 第 一輸出 針腳 所 回傳 之 視訊介面 驅動程式 的 安裝 完成 訊號 ， 而據 以 控制 切換器 切換 連接埠 ， 以 連接 此 節點 。 
 在 本 發明 之一 實施例 中 ， 上述 的 基板 管理 控制器 在 通知 所 要 切換到 之 節點 安裝 視訊介面 驅動程式 之前 ， 更 透過 第 二輸出 針腳 輸出 一 移除 訊號 至 目前 連接 節點 的 第 一輸入 針腳 ， 以 通知 此 節點 移除 視訊介面 驅動程式 ， 並 透過 第二 輸入 針腳 接收 此 節點 透過 該 第 一輸出 針腳 所 回傳 之 視訊介面 驅動程式 的 移除 完成 訊號 。 
 在 本 發明 之一 實施例 中 ， 上述 各個 節點 均 包括 晶片組 及 訊號產生器 ， 而 各個 節點 的 第一 連接 針腳 即 分別 配置 於 晶片組 及 訊號產生器 。 
 在 本 發明 之一 實施例 中 ， 上述 節點 係 兩 兩 配置 於 一個 基板 上 ， 並 透過 此 基板 上的 共用 連接埠連接 至 集線器 上 對應的 連接埠 。 
 在 本 發明 之一 實施例 中 ， 上述 之 子板 更 包括 切換單元 ， 其 係耦 接 基板 管理 控制器 以及 切換器 的 控制 針腳 ， 而 可 根據 請求指令 所 請求 使用 的 節點 以及 基板 管理 控制器 之 裝置管理 功能的 使用狀態 ， 發送 一 控制訊號 至 切換器 的 控制 針腳 ， 以 控制 切換器 切換 連接埠 。 
 本 發明 提出 一種 共用 基板 管理 控制器 的 方法 ， 適用於 包括 多個節點 、 集線器 及 子板 的 伺服器系統 ， 這些 節點 係 透過 集線器 連接 至子 板上的 基板 管理 控制器 。 此 方法 係 由 基板 管理 控制器接收 使用者 對於 上述 節點 其中 一個 節點 的 請求指令 ， 並 控制 集線器 上的 切換器 切換至 請求指令 所 請求 切換到 的 節點 ， 而 透過 第 二輸出 針腳 輸出 一 安裝 訊號 至 請求指令 所 請求 切換到 之 節點 的 第 一輸入 針腳 。 此 節點 即 根據 所 接收的 安裝 訊號 安裝 視訊介面 驅動程式 ， 並在 安裝 完成 後 ， 透過 第 一輸出 針腳 回傳 一 安裝 完成 訊號 至 基板 管理 控制器 的 第二 輸入 針腳 。 當 基板 管理 控制器接收 到 安裝 完成 訊號 之後 ， 節點 即可 透過 基板 管理 控制器 的 裝置管理 功能 使用 子板 所 連接的 周邊裝置 。 
 在 本 發明 之一 實施例 中 ， 上述 由 節點 根據 安裝 訊號 安裝 視訊介面 驅動程式 的 步驟 包括 由 節點 的 控制器 利用 安裝 訊號 更新 節點 的 通用 狀態 ， 並 觸發 一 系統中斷 以 啟動 節點 之 作業系統 下的 介面驅動器 。 接著 ， 由 介面驅動器 檢查 上述 的 通用 狀態 ， 而據 以 呼叫 第一 控制方法 以 通知 作業系統安裝 視訊介面 驅動程式 ， 以及 在 安裝 完成 後 呼叫 第二 控制方法 以 通知 控制器 輸出 安裝 完成 訊號 。 
 在 本 發明 之一 實施例 中 ， 在 上述 基板 管理 控制器 控制 集線器 上的 切換器 切換至 節點 的 步驟 之後 ， 更 包括 由 節點 中 對應 於 基板 管理 控制器 之 裝置管理 功能的 連接介面 驅動程式 通知 作業系統 重新 掃描 此 節點 的 連接介面 ， 以 透過 所述 的 裝置管理 功能 使用 子板 所 連接的 周邊裝置 。 
 在 本 發明 之一 實施例 中 ， 在 上述 由 基板 管理 控制器 控制 切換器 切換至 節點 的 步驟 之後 ， 更 包括 由 集線器 利用 上拉 暫存器 ( pull - up   register ) 上拉 基板 管理 控制器 的 第二 輸入 針腳 及第 二輸出 針腳 。 
 在 本 發明 之一 實施例 中 ， 在 上述 基板 管理 控制器接收 對於 節點 的 請求指令 的 步驟 之後 ， 更 包括 由 基板 管理 控制器 透過 第 二輸出 針腳 輸出 一 移除 訊號 至 目前 與 基板 管理 控制器 連接 並 使用 基板 管理 控制器 之 裝置管理 功能的 節點 的 第 一輸入 針腳 。 而 由此 節點 根據 移除 訊號 移除 視訊介面 驅動程式 ， 並在 移除 完成 後 透過 第 一輸出 針腳 回傳 一 移除 完成 訊號 至 基板 管理 控制器 的 第二 輸入 針腳 。 
 在 本 發明 之一 實施例 中 ， 上述 由 節點 根據 移除 訊號 移除 視訊介面 驅動程式 的 步驟 包括 由 節點 的 控制器 利用 移除 訊號 來 更新 節點 的 通用 狀態 ， 並 觸發 一 系統中斷 以 啟動 此 節點 之 作業系統 下的 介面驅動器 。 接著 ， 由 介面驅動器 檢查 通用 狀態 ， 據 以 呼叫 第一 控制方法 以 通知 作業系統 移除 視訊介面 驅動程式 。 在 視訊介面 驅動程式 移除 後 ， 由 介面驅動器 呼叫 第二 控制方法 以 通知 控制器 輸出 移除 完成 訊號 。 
 在 本 發明 之一 實施例 中 ， 在 上述 基板 管理 控制器 控制 集線器 上的 切換器 切換至 節點 的 步驟 之後 ， 更 包括 由此 節點 中 對應 於 基板 管理 控制器 之 裝置管理 功能的 連接介面 驅動程式 通知 作業系統 重新 掃描 節點 的 連接介面 ， 以 解除 使用 子板 所 連接的 周邊裝置 。 
 在 本 發明 之一 實施例 中 ， 上述 的 子板 包括 設備管理 子板 ( Enclosure   Management   Board ， EM B ) 。 上述 的 基板 管理 控制器 的 裝置管理 功能 包括 鍵盤 、 視訊 、 滑鼠 ( Keyboard   Video   Mouse ， KVM ) 控制功能 。 而 上述 的 連接單元 包括 視頻圖像 陣列 ( Video   Graphics   Array ， VGA ) 埠 、 通用序列匯流排 ( Universal   Serial   Bus ， USB ) 連接埠 或 網路連接埠 。 
 基於 上述 ， 本 發明 之 共用 基板 管理 控制器 的 伺服器系統 及 方法 係 將 伺服器系統 的 多個節點 透過 集線器 連接 至 子板 ， 並 根據 使用者選擇 的 節點 切換集線器 上的 切換器 ， 而 在 切換節 點 之前 ， 先 透過 特定的 連接 針腳 通知 節點 安裝 視訊介面 驅動程式 ， 使得 此 節點 在 連接到 基板 管理 控制器 後 ， 可 直接 透過 基板 管理 控制器 的 裝置管理 功能 使用 子板 所 連接的 周邊裝置 。 
 為 讓 本 發明 之 上述 特徵 和 優點 能 更 明顯 易懂 ， 下文 特舉 實施例 ， 並 配合 所 附圖式 作 詳細說明 如下 。 
 100 ． ． ． 伺服器系統 
 110 、 120 、 13 0 、 140 ． ． ． 節點 
 15 0 、 45 0 ． ． ． 集線器 
 120 、 46 0 ． ． ． 子板 
 15 1 、 15 2 、 15 3 、 15 4 、 45 1 、 45 2 、 45 3 、 45 4 ． ． ． 連接埠 
 15 5 、 45 5 ． ． ． 切換器 
 15 6 ． ． ． 指示燈 
 16 0 、 46 0 ． ． ． 子板 
 16 1 、 46 1 ． ． ． 連接單元 
 162 、 46 2 ． ． ． 基板 管理 控制器 
 16 3 ． ． ． 控制線 
 41 0 、 42 0 、 43 0 、 44 0 ． ． ． 基板 
 41 1 、 41 3 ． ． ． 晶片組 
 41 2 、 41 4 ． ． ． 訊號產生器 
 41 5 ． ． ． 共用 連接埠 
 46 3 ． ． ． 切換單元 
 46 4 、 46 5 ． ． ． 及閘 
 46 6 ． ． ． 多工器 
 46 7 ． ． ． 指撥 開關 
 S 30 2 ~ S3 10 ． ． ． 本 發明 第一 實施例 之 共用 基板 管理 控制器 的 方法 步驟 
 S 50 2 ~ S 51 2 ． ． ． 本 發明 第三實施例 之 共用 基板 管理 控制器 的 方法 步驟 
 S60 2 ~ S60 8 ． ． ． 本 發明 第三實施例 之 視訊介面 驅動程式 的 安裝方法 步驟 
 S7 02 ~ S7 18 ． ． ． 本 發明 第四 實施例 之 共用 基板 管理 控制器 的 方法 步驟 
 S8 02 ~ S8 08 ． ． ． 本 發明 第四 實施例 之 視訊介面 驅動程式 的 移除 方法 步驟 
 
 圖 1 是 依照 本 發明 第一 實施例 所繪示 之 共用 基板 管理 控制器 的 伺服器 系統方塊圖 。 
 圖 2 是 依照 本 發明 第一 實施例 所繪示 之 伺服器系統 100 的 通用 輸入輸出 針腳 配置圖 。 
 圖3 是 依照 本 發明 第一 實施例 所繪示 之 共用 基板 管理 控制器 的 方法流程圖 。 
 圖 4 是 依照 本 發明 第二 實施例 所繪示 之 共用 基板 管理 控制器 的 伺服器 系統方塊圖 。 
 圖 5 是 依照 本 發明 第三實施例 所繪示 之 共用 基板 管理 控制器 的 方法流程圖 。 
 圖6 是 依照 本 發明 第三實施例 所繪示 之 視訊介面 驅動程式 的 安裝方法 流程圖 。 
 圖7 是 依照 本 發明 第四 實施例 所繪示 之 共用 基板 管理 控制器 的 方法流程圖 。 
 圖8 是 依照 本 發明 第四 實施例 所繪示 之 視訊介面 驅動程式 的 移除 方法流程圖 。 
 為 了 在 有限的空間 裡 實作 出 高密度 的 平台 ， 研發人員 勢 必得將 主機板上 各個 元件 之間 的 空隙 盡 可能 排 的 緊密 。 最後 ， 為 了 騰出 更 多 的空間 ， 並 降低 單位的 生產成本 ， 一些 可共用 或量 產後 不必要 的 元件 也 就 成為 可 被 移除 的 最好 選項 。 以 資料中心 來 說 ， 主機板上 視頻圖像 陣列 ( Video   Graphics   Array ， VGA ) 埠 、 序列埠 ( Serial   port ) 並非 必要 ， 且 基板 管理 控制器 ( Base board   Management   Controller ， BMC ) 也 可以 共用 一個 ， 再者 現今 之 基板 管理 控制器 皆 包含有 VGA 控制器 與 網路功能 ， 故 整個 系統 只要 有 一個 基板 管理 控制器 對應 資料中心 之 應用 就 足夠 了 。 
 第一 實施例 
 
 圖 1 是 依照 本 發明 第一 實施例 所繪示 之 共用 基板 管理 控制器 的 伺服器 系統方塊圖 。 請 參照圖 1 ， 本 實施例 的 伺服器系統 100 包括 四個 節點 110 、 120 、 13 0 及 140 ， 以及 集線器 15 0 與 子板 16 0 ， 其 功能 分述 如下 ： 節點 110 、 120 、 13 0 及 140 分別 是 一個 獨立的電腦 系統 ， 其 包括 配置 在 基板 上的 中央處理單元 ( Central   Processing   Unit ， CPU ) 、 記憶體 、 北橋晶片 、 南橋晶片 、 網路晶片 等 電腦 元件 ， 而 可用 以 作為 資料中心 。 
 集線器 15 0 例如 是 一個 中介板 ( middle   plane ) ， 其 係 具有 連接埠 15 1 、 15 2 、 15 3 、 15 4 及 切換器 15 5 ， 其中 連接埠 15 1 、 15 2 、 15 3 、 15 4 係 分別 與 節點 110 、 120 、 13 0 及 140 的 多個針 腳 連接 ， 而 切換器 15 5 則 分別 連接 至 連接埠 15 1 、 15 2 、 15 3 、 15 4 ， 以 在 這些 連接埠 之間 切換 。 在 本 實施例 中 ， 每個節 點與 連接埠連接 的 針腳 包括 11 根 第一 連接 針腳 ( CO N   1 ) 、 1 根第 一輸入 針腳 及 1 根第 一輸出 針腳 ， 此 第 一輸入 針腳 例如 是 通用 輸入 ( General   Purpose   Input ， GPI ) 針腳 ( 即 GPI   1 ) ， 而 第 一輸出 針腳 例如 是 通用 輸出 ( General   Purpose   Output ， GP O ) 針腳 ( 即 GP O   1 ) ， 但 不 限於 此 。 
 子板 16 0 例如 是 設備管理 子板 ( Enclosure   Management   Board ， EM B ) ， 其上 配置 了 連接單元 16 1 與 基板 管理 控制器 162 。 其中 ， 連接單元 16 1 例如 是 一個 VGA 連接埠 、 通用序列匯流排 ( Universal   Serial   Bus ， USB ) 連接埠 ， 而 可用 以 連接 至 顯示器 、 鍵盤 、 滑鼠 、 儲存 等 周邊裝置 ( 未繪示 ) 。 連接單元 16 1 也 可以 是 一個 網路連接埠 ， 而 可用 以 連接 至 遠端裝置 。 
 基板 管理 控制器 162 例如 是 透過 上述 連接單元 16 1 所 連接的 周邊裝置 接收 由 使用者 對於 上述 節點 的 請求指令 ( 更 明確的 說 ， 下 IPM I   OEM 命令 至 基板 管理 控制器 162 要求 其 切換至 某 節點 ) ， 據 以 透過 控制線 16 3 由 控制 針腳 A 發出控制訊號 至 切換器 15 5 的 針腳 A ， 而 控制 切換器 15 5 切換 所 連接的 連接埠 ， 而將 請求指令 所 請求 使用 的 節點連接 至 基板 管理 控制器 162 ， 使得 此 節點 可 透過 基板 管理 控制器 162 的 裝置管理 功能 使用 子板 120 所 連接的 周邊裝置 。 所述 基板 管理 控制器 162 的 裝置管理 功能 例如 是 鍵盤 、 視訊 、 滑鼠 ( Keyboard   Video   Mouse ， KVM ) 的 控制功能 ， 但 不 限於 此 。 
 舉例 來 說 ， 若 使用者 欲 觀看 節點 120 的 測試 畫面 與操作 ， 則可 利用滑鼠 選擇節 點 120 而 下 IPM I   OEM 命令 至 基板 管理 控制器 162 要求 其 切換至 節點 120 ， 此時 基板 管理 控制器 162 即會 根據 使用者選擇 的 節點 120 ， 透過 控制 針腳 A 並 經由 控制線 16 3 發送控制訊號 ， 以 控制 切換器 15 5 切換至 與 節點 120 相連接 的 連接埠 112 ， 使得 節點 120 可 經由 連接埠 112 連接 至 基板 管理 控制器 162 ， 而 可 透過 基板 管理 控制器 162 的 裝置管理 功能 使用 子板 120 所 連接的 顯示器 、 鍵盤 、 滑鼠 、 儲存裝置 ， 讓 使用者 觀看 到 節點 120 的 測試 畫面 以及 使用 鍵盤 、 滑鼠操作 節點 120 ， 再者 節點 120 可使用 儲存裝置 來 開機 或 儲存 。 
 需 說明 的 是 ， 為 了 實現 各個節 點與 基板 管理 控制器 162 之間 的 熱插拔 ( Hot   plug ) 功能 ， 本 實施例 係 在 基板 管理 控制器 162 上 配置 對應 於 各個 節點 之 第一 連接 針腳 ( CO N   1 ) 的 多個第二 連接 針腳 ( CO N   2 ) 、 對應 於 第 一輸入 針腳 ( GPI   1 ) 的 第 二輸出 針腳 ( GP O   2 ) 以及 對應 於 第 一輸出 針腳 ( GP O   1 ) 的 第二 輸入 針腳 ( GPI   2 ) ， 而 用以 連接切換 器 ， 並 透過 切換器 與 各個 節點連接 。 
 詳言 之 ， 圖 2 是 依照 本 發明 第一 實施例 所繪示 之 伺服器系統 100 的 通用 輸入輸出 針腳 配置圖 。 請 參照圖 2 ， 本 實施例 之 基板 管理 控制器 162 係 透過 第 二輸出 針腳 ( GP O   2 ) 輸出 安裝 訊號 至 所要 切換到 之 節點 的 第 一輸入 針腳 ( GPI   1 ) ， 以 通知 節點 安裝 視訊介面 驅動程式 ， 並 透過 第二 輸入 針腳 ( GPI   2 ) 接收節點 透過 第 一輸出 針腳 ( GP O   1 ) 所 回傳 之 視訊介面 驅動程式 的 安裝 完成 訊號 ， 而據 以 透過 控制 針腳 A 控制 切換器 15 5 切換 所 連接的 連接埠 ， 以 連接 節點 。 其中 ， 指示燈 15 6 係 在 節點 完成 視訊介面 驅動程式 的 安裝 之後 點亮 ， 以 提示 使用者 目前 節點 已 連接基板 管理 控制器 162 ， 並 可使用 基板 管理 控制器 162 的 裝置管理 功能 。 
 對於 上述 的 伺服器系統 100 ， 本 發明 亦 提供 對應的 操作方法 ， 以 適當 地 分配 基板 管理 控制器 162 的 裝置管理 功能 給予 各個 節點 使用 。 圖3 是 依照 本 發明 第一 實施例 所繪示 之 共用 基板 管理 控制器 的 方法流程圖 。 請 參照圖 3 ， 本 實施例 的 方法 適用於 圖 1 的 伺服器系統 100 ， 以下 即 使用圖 1 中的 各個 元件 來 說明 此 方法 的 詳細 步驟 ： 首先 ， 由 子板 120 上的 基板 管理 控制器 162 接收 使用者 對於 節點 110 、 120 、 13 0 及 140 其中 一個 節點 的 請求指令 ( 步驟 S 30 2 ) 。 其中 ， 請求指令 所 請求 使用 的 節點 例如 是 由 使用者 撥動 子板 16 0 上的 指撥 開關 ( DIP   switch ) 來 選擇 或是 從 遠端 下達 基板 管理 控制器 指令 來 選擇 ， 在 此並 不 設限 。 
 根據 上述 的 請求指令 ， 基板 管理 控制器 162 隨即 控制 集線器 15 0 上的 切換器 15 5 切換至 請求指令 所 請求 切換到 的 節點 ( 步驟 S 304 ) ， 並 透過 第 二輸出 針腳 ( GP O2 ) 輸出 一 安裝 訊號 至 請求指令 所 請求 切換到 之 節點 的 第 一輸入 針腳 ( GPI   1 ) ( 步驟 S 30 6 ) 。 
 需 說明 的 是 ， 由於 視訊控制器 所 使用 的 高速 週邊裝置 元件互連 ( Peripheral   Component   Interconnect   Express ， PCI E ) 介面 本身 並不 支援 熱插拔 ， 須 額外 之 支援 方能 有 熱插拔 功能 ， 若 直接 將 基板 管理 控制器 162 切換至 節點 ， 節點 也 無法使用 基板 管理 控制器 162 的 視訊功能 來 驅動 視訊裝置 。 另一方面 ， 若 直接 將 基板 管理 控制器 162 與 節點 之間 的 連接 切斷 ( 例如 切換至 其他 節點 ) ， 則此 節點 會 因為 視訊功能 突然中斷 ， 而 造成 系統 崩潰 或 當機 的 情形 。 因此 ， 本 實施例 即 在 基板 管理 控制器 162 接收到 切換 請求 時 ， 要 通知 目前 擁有 基板 管理 控制器 162 之 節點 及 所要 切換到 的 節點 預 做準備 。 
 根據 上述 概念 ， 本 實施例 的 節點 在 接收到 安裝 訊號 後 ， 即 開始 安裝 視訊介面 驅動程式 ， 並在 安裝 完成 後 ， 透過 第 一輸出 針腳 ( GP O   1 ) 回傳 一個 安裝 完成 訊號 至 基板 管理 控制器 162 的 第二 輸入 針腳 ( GPI   2 ) ( 步驟 S308 ) 。 
 當 基板 管理 控制器 162 接收到 安裝 完成 訊號 時 ， 節點 即可 透過 基板 管理 控制器 162 的 裝置管理 功能 使用 子板 16 0 所 連接的 周邊裝置 ( 步驟 S3 10 ) 。 其中 ， 由於 節點 已 完成 視訊介面 驅動程式 的 安裝 ， 因此 可使用 基板 管理 控制器 162 的 視訊功能 來 使用 子板 16 0 所 連接的 視訊裝置 ( 例如 顯示器 ) ， 而 實現 熱插拔 功能 。 
 值得一提的是 ， 對於 通用序列匯流排 ( Universal   Serial   Bus ， USB ) 等 傳輸介面 而言 ， 其 是 可 直接操作 熱插拔 的 ， 即便 將節 點與 基板 管理 控制器 162 之間 的 連接切換 ， 只會 造成 資料 的 傳輸中斷 ， 而 不會 影響 節點 的 系統 運作 。 因此 ， 本 實施例 並未 針對 這些 介面 先行 安裝驅動 程式 ， 惟 熟知 本 領域 技術人員 亦可 依 實際需要 ， 參照 上述 安裝 視訊介面 驅動程式 的方式 來 預先 安裝 其他 介面 的 驅動程式 。 
 藉由 上述 實施例 的 伺服器系統 100 架構 及其 操作方法 ， 使用者 即可 透過 網路 、 基板 管理 控制器 162 在 本地端 及 遠端 顯示 節點 110 、 120 、 13 0 、 140 的 使用者介面 ， 並 可使用 本地端 及 遠端的 鍵盤 、 滑鼠 、 儲存裝置 以 對 節點 110 、 120 、 13 0 、 140 進行 維護 及 操控 。 
 第二 實施例 
 
 圖 4 是 依照 本 發明 第二 實施例 所繪示 之 共用 基板 管理 控制器 的 伺服器 系統方塊圖 。 請 參照圖 3 ， 本 實施例 的 伺服器系統 400 包括 基板 41 0 、 42 0 、 43 0 、 44 0 ， 以及 集線器 45 0 與 子板 46 0 ， 其 功能 分述 如下 ： 基板 41 0 、 42 0 、 43 0 、 44 0 上 係 分別 配置 兩個節點 以及 一個 共用 連接埠 ， 例如 基板 41 0 上 即 配置節點 1 、 節點 2 以及 共用 連接埠 41 5 ， 而 節點 1 又 包括 晶片組 41 1 及 訊號產生器 41 2 ， 節點 2 則 包括 晶片組 41 3 及 訊號產生器 41 4 。 其中 ， 節點 1 的 晶片組 41 1 具有 兩根 第一 USB 埠 針腳 ( USB   port   1 ) 、 兩根 第二 USB 埠 針腳 ( USB   port   2 ) 、 四根 高速 週邊裝置 元件互連 ( Peripheral   Component   Interconnect   Express ， PCI E ) 埠 針腳 ( PCI E   port ) 以及 兩根 第一 通用 輸入輸出 針腳 ( GPI   1 / GP O   1 ) ， 而 節點 1 的 訊號產生器 41 2 則 具有 一根 USB 時脈 針腳 ( USB   clk ) 及 兩根 PCI E 時脈 針腳 ( PCI E   clk ) 。 這些 針腳 分別 連接 至 基板 41 0 上的 共用 連接埠 41 5 。 同理 ， 節點 2 之 晶片組 41 3 及 訊號產生器 41 4 上的 針腳 也 連接 至 共同 連接埠 41 5 ， 而此 針腳 的 種類 及 數目 與 晶片組 41 1 及 訊號產生器 41 2 相同 ， 在 此 不再 贅述 。 
 集線器 45 0 係 具有 四個 連接埠 45 1 、 45 2 、 45 3 、 45 4 及 切換器 45 5 ， 其中 連接埠 45 1 、 45 2 、 45 3 、 45 4 係 分別 與 基板 41 0 、 42 0 、 43 0 、 44 0 上 對應的 共用 連接埠 ( 圖3 僅繪 示出 共用 連接埠 41 5 ) 連接 ， 其中 每一 個 共用 連接埠 係 透過 包含 26 根 針腳 的 連接線 ( cable ) 與 連接埠連接 。 此外 ， 切換器 45 5 分別 透過 兩 組接 線 ( 每 組包括 13 條 接線 ) 與連接 埠 45 1 、 45 2 、 45 3 、 45 4 連接 ， 以 在 這些 連接埠 之間 切換 。 
 子板 46 0 例如 是 設備管理 子板 ， 其上 配置 了 連接單元 46 1 、 基板 管理 控制器 46 2 與 切換單元 46 3 。 其中 ， 連接單元 46 1 例如 是 一個 VGA 埠 、 網路連接埠 或 USB 連接埠 ， 而 可用 以 連接 至 顯示器 、 鍵盤 、 滑鼠 、 儲存 等 周邊裝置 ( 未繪示 ) 。 
 基板 管理 控制器 46 2 例如 是 透過 上述 連接單元 46 1 所 連接的 周邊裝置 接收 由 使用者 對於 上述 節點 的 請求指令 ( 更 明確的 說 ， 下 IPM I   OEM 命令 至 基板 管理 控制器 46 2 要求 其 切換至 某 節點 ) ， 據 以 控制 切換器 45 5 切換 連接埠 ， 以將 請求指令 所 請求 使用 的 節點連接 至 基板 管理 控制器 46 2 ， 使得 此 節點 可 透過 基板 管理 控制器 46 2 的 裝置管理 功能 使用 子板 46 0 所 連接的 周邊裝置 。 所述 基板 管理 控制器 46 2 的 裝置管理 功能 例如 是 鍵盤 、 視訊 、 滑鼠 、 儲存 的 控制功能 ， 但 不 限於 此 。 
 對應 於 每個 節點連接 至 集線器 45 0的 13 根 針腳 ， 基板 管理 控制器 46 2 亦 透過 13 根 針腳 與 集線器 45 0的 切換器 45 5 連接 ， 以 透過 切換器 45 5 的 切換 連接 至 節點 ， 這些 針腳 在 圖3 中 由 左 至 右 依序為 一根 USB 時脈 針腳 ( USB   clk ) 、 兩根 第一 USB 埠 針腳 ( USB   1 ) 、 兩根 第二 USB 埠 針腳 ( USB   2 ) 、 四根 PCI E 埠 針腳 ( PCI E ) 、 兩根 PCI E 時脈 針腳 ( PCI E   clk ) 及 兩根 通用 輸入輸出 針腳 ( GPI   2 / GP O   2 ) 。 其中 ， 第一 USB 埠 針腳 ( USB   1 ) 是 用以 作為 儲存裝置 ； 第二 USB 埠 針腳 ( USB   2 ) 是 用以 作為 鍵盤 、 滑鼠裝置 ； PCI E 埠 針腳 ( PCI E ) 是 用以 作為 VGA 控制裝置 ； 通用 輸入 針腳 ( GPI   2 ) 是 用以 連接 節點 的 通用 輸出 針腳 ( GP O   1 ) ； 通用 輸出 針腳 ( GP O   2 ) 是 用以 連接 節點 的 通用 輸入 針腳 ( GPI   1 ) 。 
 需 說明 的 是 ， 基板 管理 控制器 46 2 還 包括 透過 針腳 A 、 B 、 C 、 D 、 E 與 切換單元 46 3 相連接 ， 以 根據 所 接收的 請求指令 ， 輸出控制訊號 至 切換單元 46 3 ， 而 由 切換單元 46 3 控制 切換器 45 5 切換 連接埠 。 其中 ， 切換單元 46 3 例如 是 由 兩個 及閘 ( AND   gate ) 46 4 、 46 5 、 多工器 46 6 及 指撥 開關 ( DIP   switch ) 46 7 所 構成 。 切換單元 46 3 更 包括 耦接 至 切換器 45 5 的 控制 針腳 A 、 B ， 而 可 根據 請求指令 所 請求 使用 的 節點 以及 基板 管理 控制器 46 2 之 裝置管理 功能的 使用狀態 ， 發送控制訊號 至 切換器 45 5 的 控制 針腳 A 、 B ， 以 控制 切換器 45 5 切換 連接埠 。 
 詳言 之 ， 基板 管理 控制器 46 2 之 針腳 A 輸出的 訊號 係 用以 選擇 使用 基板 管理 控制器 46 2 之 針腳 B 輸出的 訊號 或是 選擇 使用 指撥 開關 46 7 之 針腳 A 輸出的 訊號 。 例如 ， 基板 管理 控制器 46 2 之 針腳 A 輸出的 訊號 為 0 時 ， 代表 選擇 使用 指撥 開關 46 7 之 針腳 A 輸出的 訊號 ； 若為 1 時 ， 則 代表 選擇 使用 基板 管理 控制器 46 2 之 針腳 B 輸出的 訊號 。 
 針腳 B 輸出的 訊號 係 代表 基板 管理 控制器 46 2 所 選擇 切換 之 節點 的 代碼 ， 其 例如 透過 三根 針腳 輸出 0 與 1 的 訊號 ， 以 分別 代表 節點 1 ~ 8 ， 然此 針腳 的 數目 可 根據 系統 所 連接的 節點 數目 而定 ， 並不 限於 此 。 
 針腳 C 代表 基板 管理 控制器 46 2 的 裝置管理 功能 是否 已 被 釋出 ， 例如 針腳 C 輸出的 訊號 為 0 時代表 基板 管理 控制器 46 2 的 裝置管理 功能 已 被 釋出 ， 因此 不需 隔離 節 點與 基板 管理 控制器 46 2 之間 的 連結 ； 若為 1 時則 代表 基板 管理 控制器 46 2 的 裝置管理 功能 未 被 釋出 ， 因此 需要 隔離 節 點與 基板 管理 控制器 46 2 之間 的 連結 。 
 此外 ， 指撥 開關 46 7 的 針腳 A 、 B 係 分別 耦接 至 基板 管理 控制器 46 2 之 針腳 D 、 E ， 而 指撥 開關 46 7 的 針腳 B 的 功能 係 用以 選擇 強迫 使用 指撥 開關 46 7 的 針腳 A 去 選擇節 點 ， 或是 選擇 使用 基板 管理 控制器 46 2 選擇的 節點 。 例如 ， 當 指撥 開關 46 7 之 針腳 B 傳送 訊號 0 至 基板 管理 控制器 46 2 的 針腳 E 時 ， 即 告知 基板 管理 控制器 46 2 選擇 強迫 使用 指撥 開關 46 7 的 針腳 A 去 選擇節 點 ， 而 指撥 開關 46 7 的 針腳 A 則會 傳送 訊號 至 基板 管理 控制器 46 2 的 針腳 D ， 以 告知 基板 管理 控制器 46 2 其所 選擇的 節點 。 
 另一方面 ， 當 指撥 開關 46 7 之 針腳 B 傳送 訊號 1 至 基板 管理 控制器 46 2 的 針腳 E 時則 代表 選擇 使用 基板 管理 控制器 46 2 之 針腳 A 選擇的 節點 。 此時 ， 當 基板 管理 控制器 46 2 之 針腳 A 的 訊號 為 0 時 ， 選擇 使用 指撥 開關 46 7 的 針腳 A 去 選擇節 點 ； 當 基板 管理 控制器 46 2 之 針腳 A 的 訊號 為 1 時 ， 則 根據 基板 管理 控制器 46 2 之 針腳 B 輸出的 訊號 去 選擇節 點 。 
 值得一提的是 ， 基板 管理 控制器 46 2 還 包括 藉由 針腳 F 與 切換器 45 5 的 針腳 C 連接 ， 此 針腳 F 係 用以 閂鎖 ( Latch ) 切換器 45 5 之 針腳 A 的 訊號 ， 而 當其 訊號 由 0 轉變為 1 時 ， 才 解除 對切 換器 45 5 之 針腳 A 的 訊號 的 閂鎖 ， 以便 做 節點 的 切換 。 
 舉例 來 說 ， 當 基板 管理 控制器 46 2 之 針腳 C 輸出 0的 訊號 時即 代表 基板 管理 控制器 46 2 的 裝置管理 功能 已 被 釋出 ， 而當 指撥 開關 46 7 之 針腳 B 也 輸出 0的 訊號 時 ， 及閘 46 5 即會 輸出 0的 訊號 至 切換器 45 5 的 控制 針腳 B ， 以 解除 節 點與 基板 管理 控制器 46 2 之間 的 隔離 。 此時 ， 多工器 46 6 即會 根據 指撥 開關 46 7 之 針腳 A 輸出的 訊號 ， 選擇 將 基板 管理 控制器 46 2 之 針腳 B 的 訊號輸出 至 切換器 45 5 的 控制 針腳 A ， 以 控制 切換器 45 5 切換至 基板 管理 控制器 46 2 之 針腳 B 所 輸出訊號 對應的 連接埠 。 最後 ， 由 基板 管理 控制器 46 2 將其 針腳 F 的 訊號 由 0 轉變為 1 ， 以 解除 對切 換器 45 5 之 針腳 A 的 訊號 的 閂鎖 ， 而 執行節點 的 切換 。 
 對於 上述 的 伺服器系統 400 ， 本 發明 亦 提供 對應的 操作方法 來 切換 基板 管理 控制器 46 2 所 連接的 節點 ， 以 適當 地 分配 基板 管理 控制器 46 2 的 裝置管理 功能 給予 各個 節點 使用 。 其中 ， 切換器 45 5 在 執行 切換 時 包括 兩種情況 ， 一種 是 目前 沒有 任何 節點 使用 基板 管理 控制器 46 2 之 裝置管理 功能的 情況 ， 一種 則是 目前 已有 節點 使用 基板 管理 控制器 46 2 之 裝置管理 功能的 情況 。 以下 則 分別 舉一 實施例 詳細說明 。 
 第三實施例 
 
 本 實施例 的 方法 係 應用 在 沒有 任何 節點 使用 基板 管理 控制器 46 2 之 裝置管理 功能的 情況 下 。 圖 5 是 依照 本 發明 第三實施例 所繪示 之 共用 基板 管理 控制器 的 方法流程圖 。 請 參照圖 4 ， 本 實施例 的 方法 適用於 圖 4 的 伺服器系統 400 ， 以下 即 使用圖 4 中的 各個 元件 來 說明 此 方法 的 詳細 步驟 ： 首先 ， 由 子板 46 0 上的 基板 管理 控制器 46 2 接收 使用者 對於 節點 1 ~ 8 其中 一個 節點 的 請求指令 ( 步驟 S 50 2 ) ， 並 控制 集線器 45 0 上的 切換器 45 5 切換至 請求指令 所 請求 切換到 的 節點 ( 步驟 S 50 4 ) ， 而 透過 第 二輸出 針腳 ( GP O   2 ) 輸出 一 安裝 訊號 至 請求指令 所 請求 切換到 之 節點 的 第 一輸入 針腳 ( GPI   1 ) ( 步驟 S 50 6 ) 。 
 節點 在 接收到 安裝 訊號 後 ， 即 觸發 一 系統中斷 ， 以 通知 作業系統 執行 視訊介面 驅動程式 的 安裝 動作 ( 步驟 S 508 ) ， 並在 安裝 完成 後 ， 透過 第 一輸出 針腳 ( GP O   1 ) 回傳 一 安裝 完成 訊號 至 基板 管理 控制器 46 2 的 第二 輸入 針腳 ( GPI   2 ) ( 步驟 S 51 0 ) 。 其中 ， 所述 的 系統中斷 例如 是 系統控制中斷 ( System   Control   Interrupt ， SCI ) ， 在 此 不 設限 。 
 詳言 之 ， 圖6 是 依照 本 發明 第三實施例 所繪示 之 視訊介面 驅動程式 的 安裝方法 流程圖 。 請 參照圖 6 ， 本 實施例 係 在 節點 接收到 安裝 訊號 時 ， 由 節點 的 控制器 利用 此 安裝 訊號 來 更新 節點 的 通用 狀態 ( 步驟 S60 2 ) 。 所述 的 控制器 例如 是 基板 上的 一個 晶片組 ( chip set ) ， 而 所述 的 安裝 訊號 例如 是 傳送 至此 晶片組 上的 一個 通用 狀態 針腳 ， 藉此 更新 節點 的 通用 狀態 ( 例如 更新為 0 ) 。 
 接著 ， 控制器 即 觸發 一 系統中斷 ， 以 啟動 節點 之 作業系統 下的 介面驅動器 ( 步驟 S60 4 ) 。 此 介面驅動器 例如 是 先進 架構 電源介面 ( Advanced   Configuration   and   Power   Interface , AC PI ) 的 驅動器 ， 其 係 運用 由 作業系統 提供 的 一個 先進 架構 電源介面 表格 ( AC PI   table ) ， 以 呼叫 多種 不同的 控制方法 ， 以 通知 作業系統 執行 電源管理 等 對應的 動作 。 
 然後 ， 由 介面驅動器 檢查 通用 狀態 ， 而據 以 呼叫 第一 控制方法 ， 以 通知 作業系統安裝 視訊介面 驅動程式 ( 步驟 S60 6 ) 。 所述 的 第一 控制方法 例如 是 由 先進 架構 電源介面 機器語言 ( AC PI   Machine   Language ， AML ) 碼寫 成的 一個 通知 程式 ， 而當 介面驅動器 呼叫 此 通知 程式 後 ， 即會 傳送 一則 通知 給 作業系統 ， 以 要求 作業系統安裝 視訊介面 驅動程式 。 
 在 作業系統 完成 視訊介面 驅動程式 的 安裝 後 ， 介面驅動器 接著 呼叫 第二 控制方法 ， 以 通知 控制器 輸出 安裝 完成 訊號 ( 步驟 S60 8 ) ， 使得 基板 管理 控制器 46 2 可 根據 此 安裝 完成 訊號 ， 執行 下一個 步驟 。 此 第二 控制方法 例如 也 是 由 AML 碼寫 成的 一個 通知 程式 。 
 回到 圖 5 的 步驟 S 51 0 ， 當 基板 管理 控制器 46 2 接收到 由 節點 輸出的 安裝 完成 訊號 時 ， 此 節點 即可 透過 基板 管理 控制器 46 2 的 裝置管理 功能 使用 子板 46 0 所 連接的 周邊裝置 ( 步驟 S 51 2 ) 。 
 需 說明 的 是 ， 在 基板 管理 控制器 46 2 接收到 由 節點 輸出的 安裝 完成 訊號 之後 ， 本 實施例 還 包括 由 節點 中 對應 於 基板 管理 控制器 46 2 之 裝置管理 功能的 連接介面 驅動程式 ( 例如 USB 驅動程式 ) 通知 作業系統 重新 掃描 節點 的 連接介面 ( 未繪示 ) ， 以 透過 裝置管理 功能 使用 子板 46 0 所 連接的 周邊裝置 。 此外 ， 本 實施例 亦 包括 利用 集線器 45 0 上的 一個 上拉 暫存器 ( pull - up   register ) ( 未繪示 ) ， 將 基板 管理 控制器 46 2 之 第二 輸入 針腳 ( GPI   2 ) 及第 二輸出 針腳 ( GP O   2 ) 的 訊號 上拉 為 1 。 
 藉由 上述 方法 ， 本 實施例 之 伺服器系統 400 即可 實現 多個節點 共用 一個 基板 管理 控制器 ， 且 支援 基板 管理 控制器 的 熱插拔 功能 ， 使得 此 節點 可以 透過 基板 管理 控制器 的 裝置管理 功能 使用 子板 所 連接的 周邊裝置 ， 而 提供 使用者 對此 節點 進行操作 。 
 第四 實施例 
 
 本 實施例 的 方法 係 應用 在 目前 已 由 節點 m 使用 基板 管理 控制器 46 2 之 裝置管理 功能 ， 而 需 由 節點 m 切換至 節點 n 的 情況 。 圖7 是 依照 本 發明 第四 實施例 所繪示 之 共用 基板 管理 控制器 的 方法流程圖 。 請 參照圖 4 ， 本 實施例 的 方法 適用於 圖 4 的 伺服器系統 400 ， 以下 即 使用圖 4 中的 各個 元件 來 說明 此 方法 的 詳細 步驟 ： 首先 ， 由 子板 46 0 上的 基板 管理 控制器 46 2 接收 使用者 對於 節點 n 的 請求指令 ( 步驟 S7 02 ) 。 此時 ， 基板 管理 控制器 46 2 將 透過 第 二輸出 針腳 ( GP O   2 ) 輸出 一 移除 訊號 至 目前 與 基板 管理 控制器 46 2 連接 之 節點 m 的 第 一輸入 針腳 ( GPI   1 ) ( 步驟 S7 04 ) 。 
 此時 ， 節點 m 即 藉由 觸發 一 系統中斷 ， 以 通知 作業系統 執行 視訊介面 驅動程式 的 移除 動作 ( 步驟 S7 06 ) ， 並在 移除 完成 後 ， 透過 其 第 一輸出 針腳 ( GP O   1 ) 回傳 一 移除 完成 訊號 至 基板 管理 控制器 46 2 的 第二 輸入 針腳 ( GPI   2 ) ( 步驟 S7 08 ) ， 以 通知 基板 管理 控制器 46 2 其 已 移除 視訊介面 驅動程式 。 
 詳言 之 ， 圖8 是 依照 本 發明 第四 實施例 所繪示 之 視訊介面 驅動程式 的 移除 方法流程圖 。 請 參照圖 8 ， 本 實施例 係 在 節點 m 接收到 移除 訊號 時 ， 由 節點 m 的 控制器 利用 此 移除 訊號 來 更新 節點 m 的 通用 狀態 ( 步驟 S8 02 ) 。 所述 的 控制器 例如 是 基板 上的 一個 晶片組 ， 而 所述 的 移除 訊號 例如 是 傳送 至此 晶片組 上的 一個 通用 狀態 針腳 ， 藉此 更新 節點 m 的 通用 狀態 ( 例如 更新為 1 ) 。 
 接著 ， 控制器 即 觸發 一 系統中斷 ， 以 啟動 節點 m 之 作業系統 下的 介面驅動器 ( 步驟 S8 04 ) 。 此 介面驅動器 例如 是 先進 架構 電源介面 的 驅動器 。 
 然後 ， 由 介面驅動器 檢查 通用 狀態 ， 而據 以 呼叫 第一 控制方法 ， 以 通知 作業系統 移除 視訊介面 驅動程式 ( 步驟 S8 06 ) 。 所述 的 第一 控制方法 例如 是 由 AML 碼寫 成的 一個 通知 程式 ， 而當 介面驅動器 呼叫 此 通知 程式 後 ， 即會 傳送 一則 通知 給 作業系統 ， 以 要求 作業系統 移除 視訊介面 驅動程式 。 
 在 作業系統 完成 視訊介面 驅動程式 的 移除 後 ， 介面驅動器 接著 呼叫 第二 控制方法 ， 以 通知 控制器 輸出 移除 完成 訊號 ( 步驟 S8 08 ) ， 使得 基板 管理 控制器 46 2 可 根據 此 安裝 完成 訊號 ， 執行 下一個 步驟 。 所述 的 第二 控制方法 例如 也 是 由 AML 碼寫 成的 通知 程式 。 
 回到 圖7 的 步驟 S7 08 ， 在 基板 管理 控制器 46 2 通知 節點 m 移除 視訊介面 驅動程式 的 同時 ， 還 包括 控制 集線器 45 0 上的 切換器 45 5 切換至 節點 n ( 步驟 S7 10 ) ， 並 透過 第 二輸出 針腳 ( GP O   2 ) 輸出 一 安裝 訊號 至 請求指令 所 請求 切換到 之 節點 的 第 一輸入 針腳 ( GPI   1 ) ( 步驟 S7 12 ) 。 
 節點 在 接收到 此 安裝 訊號 後 ， 即 自動執行 視訊介面 驅動程式 的 安裝 動作 ( 步驟 S7 14 ) ， 並在 安裝 完成 後 ， 透過 第 一輸出 針腳 ( GP O   1 ) 回傳 一 安裝 完成 訊號 至 基板 管理 控制器 46 2 的 第二 輸入 針腳 ( GPI   2 ) ( 步驟 S7 16 ) 。 其中 ， 節點 在 接收到 安裝 訊號 後 ， 例如 是 藉由 觸發 一 系統中斷 ， 以 通知 作業系統 執行 視訊介面 驅動程式 的 安裝 動作 ， 而 其 詳細 步驟 與 第三實施例 中 所述 視訊介面 驅動程式 的 安裝 動作 相同 或 相似 ， 故 在 此 不再 贅述 。 
 最後 ， 當 基板 管理 控制器 46 2 接收到 由 節點 n 輸出的 安裝 完成 訊號 時 ， 節點 n 即可 透過 基板 管理 控制器 46 2 的 裝置管理 功能 使用 子板 46 0 所 連接的 周邊裝置 ( 步驟 S7 18 ) 。 
 需 說明 的 是 ， 因 USB 介面 其為 可 熱插拔 介面 ， 故 在 節點 m 回 傳移 除 完成 訊號 之後 ， 節點 m 中 對應 於 基板 管理 控制器 46 2 之 裝置管理 功能的 連接介面 驅動程式 例如 會 通知 節點 m 的 作業系統 重新 掃描 節點 m 的 連接介面 ， 以 透過 裝置管理 功能 使用 子板 46 0 所 連接的 周邊裝置 。 此外 ， 在 節點 n 回傳 安裝 完成 訊號 之後 ， 節點 n 中 對應 於 基板 管理 控制器 46 2 之 裝置管理 功能的 連接介面 驅動程式 也 會 通知 節點 n 的 作業系統 重新 掃描 節點 n 的 連接介面 ， 以 透過 裝置管理 功能 使用 子板 46 0 所 連接的 周邊裝置 。 再者 ， 本 實施例 亦 包括 利用 集線器 45 0 上的 一個 上拉 暫存器 ( 未繪示 ) ， 將 基板 管理 控制器 46 2 之 第二 輸入 針腳 ( GPI   2 ) 及第 二輸出 針腳 ( GP O   2 ) 的 訊號 上拉 為 1 。 
 藉由 上述 方法 ， 本 實施例 之 伺服器系統 400 即可 實現 多個節點 共用 一個 基板 管理 控制器 ， 且 支援 基板 管理 控制器 的 熱插拔 功能 ， 使得 節點 之間 可 自由 切換 以 透過 基板 管理 控制器 的 裝置管理 功能 使用 子板 所 連接的 周邊裝置 ， 而 提供 使用者 隨時 在 節點 之間 切換 以 進行操作 。 
 綜上 所述 ， 本 發明 的 共用 基板 管理 控制器 的 伺服器系統 及 方法 係 藉由 共用 一個 基板 管理 控制器 ， 達到 所有 節點 皆 具有 鍵盤 、 視訊 、 滑鼠 ( KVM ) 的 控制功能 ， 而 降低 伺服器系統 的 生產成本 。 此外 ， 藉由 在 節點 使用 基板 管理 控制器 的 裝置管理 功能 之前 預先 通知 節點 安裝 或 移除 視訊介面 驅動程式 ， 則可 提供 使用者 隨時 切換節 點以 進行操作 的 彈性 。 
 雖 然本 發明 已以 實施例 揭露 如 上 ， 然其 並非 用以 限定 本 發明 ， 任何 所屬技 術領域 中 具有通 常知識者 ， 在 不 脫離 本 發明 之 精神 和範 圍內 ， 當可作 些許 之 更動 與 潤飾 ， 故本 發明 之 保護範圍 當視後附 之 申請專利範圍 所 界定者 為準 。 
 一種 共用 基板 管理 控制器 的 伺服器系統 ， 包括 ： 多個節點 ， 各該 些 節點 包括 一 晶片組 及 一 訊號產生器 、 多個 第一 連接 針腳 、 一第 一輸入 針腳 及 一第 一輸出 針腳 ， 其中 各該 些 節點 的 該些 第一 連接 針腳 分別 配置 於 對應的 該 晶片組 及 該訊號產生器 ； 一集線器 ， 具有 多個連接埠 及 一 切換器 ， 該些 連接埠 分別 連接 對應節點 的 該些 第一 連接 針腳 、 該 第 一輸入 針腳 及 該 第 一輸出 針腳 ， 該 切換器 切換 所 連接的 連接埠 ； 以及 一 子板 ， 包括 ： 至少 一 連接單元 ， 連接 至少 一 周邊裝置 ； 以及 一 基板 管理 控制器 ， 具有 對應 於 該些 第一 連接 針腳 的 多個第二 連接 針腳 、 對應 於 該 第 一輸入 針腳 的 一第 二輸出 針腳 以及 對應 於 該 第 一輸出 針腳 的 一 第二 輸入 針腳 ， 用以 連接 該 切換器 及 該 至少 一 連接單元 ， 接收 對於 該些 節點 其中 之一 的 一 請求指令 ， 據 以 控制 該 切換器 切換 連接埠 ， 以將 該 請求指令 所 請求 切換到 的 該 節點連接 至該 基板 管理 控制器 ， 使得 該 請求指令 所 請求 切換到 的 該 節點 可 透過 該 基板 管理 控制器 的 一 裝置管理 功能 使用 該些 周邊裝置 ， 其中 該 基板 管理 控制器 包括 透過 該 第 二輸出 針腳 輸出 一 安裝 訊號 至 所要 切換到 之該 節點 的 該 第 一輸入 針腳 ， 以 通知 該 請求指令 所 請求 切換到 的 該 節點 安裝 一 視訊介面 驅動程式 ， 並 透過 該 第二 輸入 針腳 接收 該 請求指令 所 請求 切換到 的 該 節點 透過 該 第 一輸出 針腳 所 回傳 之該 視訊介面 驅動程式 的 一 安裝 完成 訊號 。 
 
 如 申請專利範圍 第1 項 所述 之 伺服器系統 ， 其中 該 基板 管理 控制器 在 通知 所 要 切換到 之該 節點 安裝 該 視訊介面 驅動程式 之前 ， 更 包括 透過 該 第 二輸出 針腳 輸出 一 移除 訊號 至 目前 連接 節點 的 該 第 一輸入 針腳 ， 以 通知 該 目前 連接 節點 移除 該 視訊介面 驅動程式 ， 並 透過 該 第二 輸入 針腳 接收 該 節點 透過 該 第 一輸出 針腳 所 回傳 之該 視訊介面 驅動程式 的 一 移除 完成 訊號 。 
 
 如 申請專利範圍 第1 項 所述 之 伺服器系統 ， 其中 該 子板 更 包括 ： 一 切換單元 ， 耦接 該 基板 管理 控制器 及 該 切換器 的 一 控制 針腳 ， 根據 該 請求指令 所 請求 使用 的 該 節點 以及 該 基板 管理 控制器 之該 裝置管理 功能的 一 使用狀態 ， 發送 一 控制訊號 至該 切換器 的 該 控制 針腳 ， 以 控制 該 切換器 切換 連接埠 。 
 
 一種 共用 基板 管理 控制器 的 方法 ， 適用於 包括 多個節點 、 一集線器 及 一 子板 的 一 伺服器系統 ， 該些 節點 係 透過 該 集線器 連接 至 該子 板上的 一 基板 管理 控制器 ， 該 方法 包括 下列 步驟 ： 該 基板 管理 控制器接收 對於 該些 節點 其中 之一 的 一 請求指令 ； 該 基板 管理 控制器 控制 該 集線器 上的 一 切換器 切換至 該 請求指令 所 請求 切換到 的 該 節點 ； 該 基板 管理 控制器 透過 一第 二輸出 針腳 輸出 一 安裝 訊號 至該 請求指令 所 請求 切換到 的 該 節點 的 一第 一輸入 針腳 ； 該 請求指令 所 請求 切換到 的 該 節點 根據 該 安裝 訊號 安裝 一 視訊介面 驅動程式 ， 並在 安裝 完成 後 ， 透過 一第 一輸出 針腳 回傳 一 安裝 完成 訊號 至該 基板 管理 控制器 的 一 第二 輸入 針腳 ； 以及 該 請求指令 所 請求 切換到 的 該 節點 透過 該 基板 管理 控制器 的 一 裝置管理 功能 使用 該 子板 所 連接的 至少 一 周邊裝置 。 
 
 如 申請專利範圍 第 4 項 所述 之 共用 基板 管理 控制器 的 方法 ， 其中 該 請求指令 所 請求 切換到 的 該 節點 根據 該 安裝 訊號 安裝 該 視訊介面 驅動程式 的 步驟 包括 ： 該 請求指令 所 請求 切換到 的 該 節點 之一 控制器 利用 該 安裝 訊號 更新 該 節點 之一 通用 狀態 ； 該 控制器 觸發 一 系統中斷 以 啟動 該 請求指令 所 請求 切換到 的 該 節點 之一 作業系統 下的 一 介面驅動器 ； 該 介面驅動器 檢查 該 通用 狀態 ， 而據 以 呼叫 一 第一 控制方法 以 通知 該 作業系統安裝 該 視訊介面 驅動程式 ； 以及 在 該 視訊介面 驅動程式 安裝 完成 後 ， 由該 介面驅動器 呼叫 一 第二 控制方法 以 通知 該 控制器 輸出 該 安裝 完成 訊號 。 
 
 如 申請專利範圍 第 5 項 所述 之 共用 基板 管理 控制器 的 方法 ， 其中 在 該 基板 管理 控制器 控制 該 集線器 上的 該 切換器 切換至 該 請求指令 所 請求 切換到 的 該 節點 的 步驟 之後 ， 更 包括 ： 由該 節點 中 對應 於 該 基板 管理 控制器 之該 裝置管理 功能的 一 連接介面 驅動程式 通知 該 作業系統 重新 掃描 該 節點 的 一 連接介面 ， 以 透過 該 裝置管理 功能 使用 該 子板 所 連接的 該 至少 一 周邊裝置 。 
 
 如 申請專利範圍 第 5 項 所述 之 共用 基板 管理 控制器 的 方法 ， 其中 在 該 基板 管理 控制器 控制 該 集線器 上的 該 切換器 切換至 該 請求指令 所 請求 切換到 的 該 節點 的 步驟 之後 ， 更 包括 ： 該 集線器 利用 一 上拉 暫存器 ( pull - up   register ) 上拉 該 基板 管理 控制器 的 該 第二 輸入 針腳 及 該 第 二輸出 針腳 。 
 
 如 申請專利範圍 第 5 項 所述 之 共用 基板 管理 控制器 的 方法 ， 其中 在 該 基板 管理 控制器接收 對於 該些 節點 其中 之一 的 該 請求指令 的 步驟 之後 ， 更 包括 ： 該 基板 管理 控制器 透過 該 第 二輸出 針腳 輸出 一 移除 訊號 至 目前 與 該 基板 管理 控制器 連接 之 節點 的 第 一輸入 針腳 ； 以及 該 節點 根據 該 移除 訊號 移除 該 視訊介面 驅動程式 ， 並在 移除 完成 後 ， 透過 該 第 一輸出 針腳 回傳 一 移除 完成 訊號 至該 基板 管理 控制器 的 該 第二 輸入 針腳 。 
 
 如 申請專利範圍 第 8 項 所述 之 共用 基板 管理 控制器 的 方法 ， 其中 該 請求指令 所 請求 切換到 的 該 節點 根據 該 移除 訊號 移除 該 視訊介面 驅動程式 的 步驟 包括 ： 該 請求指令 所 請求 切換到 的 該 節點 之一 控制器 利用 該 移除 訊號 更新 該 請求指令 所 請求 切換到 的 該 節點 之一 通用 狀態 ； 該 控制器 觸發 一 系統中斷 以 啟動 該 請求指令 所 請求 切換到 的 該 節點 之一 作業系統 下的 一 介面驅動器 ； 該 介面驅動器 檢查 該 通用 狀態 ， 而據 以 呼叫 一 第一 控制方法 以 通知 該 作業系統 移除 該 視訊介面 驅動程式 ； 以及 在 該 視訊介面 驅動程式 移除 後 ， 由該 介面驅動器 呼叫 一 第二 控制方法 以 通知 該 控制器 輸出 該 移除 完成 訊號 。 
 
 如 申請專利範圍 第 9 項 所述 之 共用 基板 管理 控制器 的 方法 ， 其中 在 該 基板 管理 控制器 控制 該 集線器 上的 該 切換器 切換至 該 請求指令 所 請求 切換到 的 該 節點 的 步驟 之後 ， 更 包括 ： 由該 節點 中 對應 於 該 基板 管理 控制器 之該 裝置管理 功能的 一 連接介面 驅動程式 通知 該 作業系統 重新 掃描 該 節點 的 一 連接介面 ， 以 解除 使用 該 子板 所 連接的 該 至少 一 周邊裝置 。 
 